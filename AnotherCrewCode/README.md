# Telegram-бот "Персональный ассистент для достижения целей"

Бот помогает пользователям ставить цели, генерировать ежедневные задачи и отслеживать прогресс с помощью Google Sheets.

## Возможности

- Получение и уточнение глобальной цели пользователя через ChatGPT
- Генерация списка ежедневных задач для достижения цели
- Отслеживание прогресса в Google-таблице
- Ежедневные напоминания и мотивационные сообщения
- Вечерние опросы о прогрессе

## Технические требования

- Python 3.11 или выше
- Telegram API-токен
- OpenAI API-ключ
- Учетные данные сервисного аккаунта Google

## Установка

1. Клонируйте репозиторий:

```bash
git clone <url-репозитория>
cd goal-assistant
```

2. Создайте и активируйте виртуальное окружение:

```bash
python -m venv .venv
source .venv/bin/activate  # для Linux/Mac
.venv\Scripts\activate     # для Windows
```

3. Установите зависимости:

```bash
pip install -r requirements.txt
```

## Настройка окружения

### 1. Настройка Telegram

1. Получите токен бота у [BotFather](https://t.me/BotFather)
2. Экспортируйте токен в переменную окружения:

```bash
export TELEGRAM_TOKEN="ваш_токен"  # для Linux/Mac
set TELEGRAM_TOKEN=ваш_токен       # для Windows
```

### 2. Настройка OpenAI API

1. Получите API-ключ от [OpenAI](https://platform.openai.com/api-keys)
2. Экспортируйте ключ в переменную окружения:

```bash
export OPENAI_API_KEY="ваш_API_ключ"  # для Linux/Mac
set OPENAI_API_KEY=ваш_API_ключ       # для Windows
```

### 3. Настройка Google Sheets API

1. Создайте проект в [Google Cloud Console](https://console.cloud.google.com/)
2. Включите Google Sheets API и Google Drive API
3. Создайте сервисный аккаунт и скачайте JSON-файл с учетными данными
4. Экспортируйте путь к файлу с учетными данными:

```bash
export GOOGLE_SERVICE_ACCOUNT_FILE="путь_к_файлу.json"  # для Linux/Mac
set GOOGLE_SERVICE_ACCOUNT_FILE=путь_к_файлу.json       # для Windows
```

## Запуск

### Запуск бота

```bash
python bot.py
```

### Запуск демонстрационного режима

Для тестирования основного функционала без запуска бота:

```bash
python core.py demo
```

### Запуск тестов

```bash
pytest tests.py -v
```

## Команды бота

- `/start` - Начать работу с ботом
- `/help` - Показать справку
- `/setgoal` - Установить новую цель
- `/today` - Показать задачи на сегодня
- `/status` - Проверить статус выполнения цели
- `/motivate` - Получить мотивационное сообщение
- `/evening` - Отчет о выполнении задач за день

## Структура проекта

- `bot.py` - Telegram-обработчики
- `core.py` - Бизнес-логика (цели, задачи, расписание)
- `gsheet.py` - Обертка Google Sheets
- `llm.py` - Работа с OpenAI
- `scheduler.py` - Планировщик напоминаний
- `config.py` - Конфигурация
- `tests.py` - PyTest + моки

## Советы по масштабированию

- **Кэширование LLM-ответов**: добавьте Redis для кэширования запросов к OpenAI
- **Шардирование таблиц**: создавайте отдельные листы для разных периодов времени
- **Многопользовательский режим**: внедрите базу данных (SQLite, PostgreSQL) для хранения данных пользователей
- **Контейнеризация**: используйте Docker для упрощения развертывания
- **Мониторинг**: добавьте отправку логов в сервисы мониторинга (Sentry, Datadog)
- **Избегайте лимитов API**: реализуйте очереди для отложенной обработки запросов
- **Сохранение состояния**: используйте Redis или базу данных для сохранения состояния при перезапуске 